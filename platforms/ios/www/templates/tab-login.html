<ion-view title="Welcome!" class="bg">
  <ion-content class="has-header padding">
  
    <img id="rescaled_logo" src="img/geomap.jpg" border='5'>
      <div class="list">
        <label class="item item-input">
          <span class="input-label">User/Email</span>
          <input id='email' type="text">
        </label>
        <label class="item item-input">
          <span class="input-label">Password</span>
          <input id='password' type="password">
        </label>
      </div>
      <div class="padding">
        <button id="btnPost" class="button button-block button-positive">Sign In</button>
      </div>
     
     <script type="text/javascript">
       angular.element('#btnPost').on('click', function () {
 
    var params = {
      'email': angular.element('#email').val(),
      'password': angular.element('#password').val(),
    };
 
   // $.post("http://capstone.dev/ajax/post", params, successCallback);
 
    angular.element.ajax({
      type: "POST",
      url: "http://capstone.dev/ajax/post",
      data: params,
      error: function(jqXHR, strError){
        if (strError == 'timeout')
        {
          angular.element('#email').val('error');
        }
      },
      success: successCallback,
      dataType: "json",
      timeout: 3000
    });

  //   $http.post('http://capstone.dev/ajax/post', params).
  //   success(function(data, status, headers, config) {
  //     angular.element('#email').val('success');
  //   }).
  //   error(function(data, status, headers, config) {
  //     angular.element('#email').val('fail');
  //   });
 
  });

  var response;
 
  function successCallback(data) {
 
      response = data.isAuthorized;

      if(response) {
        angular.element.ajax({
          type: "POST",
          url: "http://capstone.dev/ajax/post",
          'data': data,
          error: function(jqXHR, strError){
            if (strError == 'timeout')
            {
              angular.element('#email').val('error');
            }
          },
          success: successCallback,
          dataType: "json",
          timeout: 3000
        });
        window.location="#/tab/dash";

      } else {

        $location.path('/');
      }

  }
 

</script>
  </ion-content>
</ion-view>